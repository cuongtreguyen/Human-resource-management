# üîÑ HR MANAGEMENT SYSTEM - FLOW DIAGRAM

## üìä SYSTEM ARCHITECTURE OVERVIEW

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   FRONTEND      ‚îÇ    ‚îÇ    BACKEND      ‚îÇ    ‚îÇ   DATABASE      ‚îÇ
‚îÇ   (React)       ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (Flask API)   ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (SQLite)      ‚îÇ
‚îÇ   Port: 5173    ‚îÇ    ‚îÇ   Port: 5000    ‚îÇ    ‚îÇ   hr_system.db  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚ñº                       ‚ñº                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   FACE RECOG    ‚îÇ    ‚îÇ   FILE STORAGE  ‚îÇ    ‚îÇ   AUDIT LOGS    ‚îÇ
‚îÇ   (OpenCV)      ‚îÇ    ‚îÇ   (Uploads)     ‚îÇ    ‚îÇ   (System Logs) ‚îÇ
‚îÇ   Camera Input  ‚îÇ    ‚îÇ   Images/Docs   ‚îÇ    ‚îÇ   User Actions  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîê AUTHENTICATION FLOW

```mermaid
sequenceDiagram
    participant U as User
    participant F as Frontend
    participant B as Backend API
    participant D as Database
    participant J as JWT Service

    U->>F: Enter email/password
    F->>B: POST /api/auth/login
    B->>D: Validate credentials
    D-->>B: User data + role
    B->>J: Generate JWT token
    J-->>B: JWT token
    B-->>F: {token, user, role}
    F->>F: Store token in localStorage
    F->>F: Redirect based on role
    Note over F: Admin/Manager ‚Üí /dashboard<br/>Employee ‚Üí /employee
```

---

## üë• EMPLOYEE MANAGEMENT FLOW

```mermaid
flowchart TD
    A[Admin/Manager Login] --> B[Employee List Page]
    B --> C{Action?}
    
    C -->|View| D[Employee Details]
    C -->|Add| E[Add Employee Form]
    C -->|Edit| F[Edit Employee Form]
    C -->|Delete| G[Confirm Delete]
    C -->|Export| H[Export Options]
    
    E --> I[Submit Form]
    F --> I
    I --> J[POST /api/employees]
    J --> K[Validate Data]
    K --> L[Save to Database]
    L --> M[Return Success]
    M --> N[Update UI]
    
    G --> O[DELETE /api/employees/:id]
    O --> P[Soft Delete/Archive]
    P --> Q[Update Status]
    
    H --> R[Select Format & Filters]
    R --> S[POST /api/employees/export]
    S --> T[Generate File]
    T --> U[Download File]
```

---

## ‚è∞ ATTENDANCE MANAGEMENT FLOW

```mermaid
flowchart TD
    A[Employee Portal] --> B[Face Recognition Page]
    B --> C[Start Camera]
    C --> D[Capture Photo]
    D --> E[POST /api/attendance/face-recognition]
    
    E --> F[Face Detection]
    F --> G{Face Found?}
    G -->|No| H[Error: No face detected]
    G -->|Yes| I[Face Encoding]
    
    I --> J[Compare with Database]
    J --> K{Match Found?}
    K -->|No| L[Error: Unknown person]
    K -->|Yes| M[Check Confidence]
    
    M --> N{Confidence > 80%?}
    N -->|No| O[Error: Low confidence]
    N -->|Yes| P[Record Attendance]
    
    P --> Q[Check In/Out Logic]
    Q --> R[Update Database]
    R --> S[Return Success]
    S --> T[Show Success Message]
    
    H --> U[Show Error Message]
    L --> U
    O --> U
```

---

## üí∞ PAYROLL CALCULATION FLOW

```mermaid
flowchart TD
    A[Payroll Management] --> B[Select Month & Employees]
    B --> C[POST /api/payroll/calculate]
    
    C --> D[Get Attendance Data]
    D --> E[Calculate Base Salary]
    E --> F[Calculate Overtime]
    F --> G[Calculate Bonuses]
    G --> H[Calculate Deductions]
    
    H --> I[Apply Tax Rules]
    I --> J[Generate Payroll Records]
    J --> K[Save to Database]
    K --> L[Return Payroll Data]
    
    L --> M[Display Payroll List]
    M --> N{Action?}
    N -->|Export| O[Generate PDF/Excel]
    N -->|Approve| P[Mark as Approved]
    N -->|Send| Q[Email Payslips]
```

---

## üìÖ LEAVE REQUEST FLOW

```mermaid
sequenceDiagram
    participant E as Employee
    participant F as Frontend
    participant B as Backend
    participant M as Manager
    participant D as Database

    E->>F: Submit Leave Request
    F->>B: POST /api/leaves
    B->>D: Save Leave Request
    D-->>B: Leave ID
    B->>B: Send Notification to Manager
    B-->>F: Success Response
    
    Note over M: Manager receives notification
    
    M->>F: View Pending Leaves
    F->>B: GET /api/leaves?status=pending
    B->>D: Query Pending Leaves
    D-->>B: Leave Requests
    B-->>F: Leave List
    
    M->>F: Approve/Reject Leave
    F->>B: PUT /api/leaves/:id/status
    B->>D: Update Leave Status
    B->>B: Send Notification to Employee
    B-->>F: Success Response
    
    Note over E: Employee receives notification
```

---

## üîç AUDIT LOG FLOW

```mermaid
flowchart TD
    A[User Action] --> B[API Endpoint]
    B --> C[Business Logic]
    C --> D[Database Operation]
    D --> E[Log Entry Creation]
    
    E --> F[Audit Log Service]
    F --> G[Format Log Data]
    G --> H[Save to audit_logs table]
    
    H --> I[Log Structure]
    I --> J[timestamp: 2024-01-15T10:30:00Z]
    I --> K[user: admin@company.com]
    I --> L[action: create/update/delete]
    I --> M[resource: employee/attendance/payroll]
    I --> N[details: Created employee Nguy·ªÖn VƒÉn An]
    I --> O[ipAddress: 192.168.1.100]
    
    P[Admin Views Logs] --> Q[GET /api/logs]
    Q --> R[Filter & Search]
    R --> S[Return Log Data]
    S --> T[Display in Logs Monitor]
```

---

## üìä DASHBOARD DATA FLOW

```mermaid
flowchart TD
    A[User Login] --> B[Role Check]
    B --> C{User Role?}
    
    C -->|Admin/Manager| D[Admin Dashboard]
    C -->|Employee| E[Employee Portal]
    
    D --> F[GET /api/dashboard/stats]
    F --> G[Query Multiple Tables]
    G --> H[Calculate Statistics]
    H --> I[Return Dashboard Data]
    
    I --> J[Total Employees: 150]
    I --> K[Active Employees: 145]
    I --> L[Today Attendance: 142]
    I --> M[Pending Leaves: 8]
    I --> N[Monthly Payroll: 2.5B VND]
    
    E --> O[GET /api/employee/dashboard]
    O --> P[Employee Specific Data]
    P --> Q[Personal Attendance]
    P --> R[Personal Payroll]
    P --> S[Personal Tasks]
    P --> T[Personal Documents]
```

---

## üîÑ REAL-TIME FACE RECOGNITION FLOW

```mermaid
sequenceDiagram
    participant C as Camera
    participant F as Frontend
    participant B as Backend
    participant AI as Face Recognition AI
    participant D as Database

    C->>F: Video Stream
    F->>F: Capture Frame
    F->>B: POST /api/face-recognition/process
    Note over F,B: Base64 encoded image
    
    B->>AI: Process Image
    AI->>AI: Detect Faces
    AI->>AI: Extract Face Encoding
    
    AI->>D: Compare with Known Faces
    D-->>AI: Match Results
    
    AI-->>B: Recognition Result
    B->>B: Calculate Confidence
    B->>B: Check Business Rules
    
    B-->>F: Recognition Response
    F->>F: Update UI
    F->>F: Show Result
    
    Note over B: If confidence > 80%<br/>Record attendance
```

---

## üìã API REQUEST/RESPONSE FLOW

```mermaid
flowchart TD
    A[Frontend Request] --> B[API Gateway]
    B --> C[Authentication Check]
    C --> D{JWT Valid?}
    
    D -->|No| E[401 Unauthorized]
    D -->|Yes| F[Role Permission Check]
    
    F --> G{Permission OK?}
    G -->|No| H[403 Forbidden]
    G -->|Yes| I[Route to Controller]
    
    I --> J[Business Logic]
    J --> K[Database Query]
    K --> L[Data Processing]
    L --> M[Response Formatting]
    
    M --> N[200 Success Response]
    M --> O[Error Handling]
    
    N --> P[JSON Response]
    O --> Q[Error Response]
    
    P --> R[Frontend Update]
    Q --> S[Show Error Message]
```

---

## üóÑÔ∏è DATABASE RELATIONSHIPS

```mermaid
erDiagram
    USERS ||--o{ EMPLOYEES : "has"
    EMPLOYEES ||--o{ ATTENDANCE : "records"
    EMPLOYEES ||--o{ PAYROLL : "receives"
    EMPLOYEES ||--o{ LEAVES : "requests"
    EMPLOYEES ||--o{ TASKS : "assigned"
    EMPLOYEES ||--o{ FACE_ENCODINGS : "has"
    
    USERS {
        string id PK
        string email
        string password_hash
        string role
        datetime created_at
        datetime updated_at
    }
    
    EMPLOYEES {
        string id PK
        string user_id FK
        string first_name
        string last_name
        string email
        string phone
        string department
        string position
        decimal salary
        date hire_date
        string status
        json personal_info
        json employment_info
    }
    
    ATTENDANCE {
        string id PK
        string employee_id FK
        date date
        time check_in
        time check_out
        string status
        decimal hours_worked
        decimal overtime
        string recognition_type
        decimal confidence
    }
    
    PAYROLL {
        string id PK
        string employee_id FK
        string month
        decimal base_salary
        decimal overtime
        decimal bonuses
        decimal deductions
        decimal net_salary
        string status
    }
    
    LEAVES {
        string id PK
        string employee_id FK
        string type
        date start_date
        date end_date
        integer days
        string reason
        string status
        string approved_by
    }
    
    FACE_ENCODINGS {
        string id PK
        string employee_id FK
        blob face_encoding
        string image_path
        datetime created_at
    }
    
    AUDIT_LOGS {
        string id PK
        string user_id FK
        string action
        string resource
        text details
        string ip_address
        datetime timestamp
    }
```

---

## üöÄ DEPLOYMENT FLOW

```mermaid
flowchart TD
    A[Development] --> B[Code Review]
    B --> C[Testing]
    C --> D[Build Process]
    
    D --> E[Frontend Build]
    D --> F[Backend Build]
    
    E --> G[React Build]
    F --> H[Python Package]
    
    G --> I[Docker Frontend]
    H --> J[Docker Backend]
    
    I --> K[Container Registry]
    J --> K
    
    K --> L[Production Deployment]
    L --> M[Load Balancer]
    M --> N[Frontend Container]
    M --> O[Backend Container]
    M --> P[Database Container]
    
    N --> Q[Port 5173]
    O --> R[Port 5000]
    P --> S[Port 5432]
```

---

## üì± USER JOURNEY FLOWS

### Admin Journey:
```
Login ‚Üí Dashboard ‚Üí Employee Management ‚Üí Add Employee ‚Üí Face Registration ‚Üí Attendance Monitoring ‚Üí Payroll Generation ‚Üí Reports
```

### Manager Journey:
```
Login ‚Üí Dashboard ‚Üí Employee List ‚Üí Attendance Management ‚Üí Leave Approvals ‚Üí Payroll Review ‚Üí Reports
```

### Employee Journey:
```
Login ‚Üí Employee Portal ‚Üí Face Recognition Check-in ‚Üí View Attendance ‚Üí Request Leave ‚Üí View Payroll ‚Üí Personal Documents
```

---

## üîß ERROR HANDLING FLOW

```mermaid
flowchart TD
    A[API Request] --> B[Try Process]
    B --> C{Success?}
    
    C -->|Yes| D[Return Success Response]
    C -->|No| E[Error Type?]
    
    E -->|Validation Error| F[400 Bad Request]
    E -->|Authentication Error| G[401 Unauthorized]
    E -->|Permission Error| H[403 Forbidden]
    E -->|Not Found| I[404 Not Found]
    E -->|Server Error| J[500 Internal Server Error]
    
    F --> K[Return Error Details]
    G --> K
    H --> K
    I --> K
    J --> K
    
    K --> L[Frontend Error Handling]
    L --> M[Show User-Friendly Message]
    L --> N[Log Error for Debugging]
```

---

## üìä MONITORING & LOGGING FLOW

```mermaid
flowchart TD
    A[System Activity] --> B[Log Generation]
    B --> C[Log Levels]
    
    C --> D[INFO: Normal Operations]
    C --> E[WARN: Potential Issues]
    C --> F[ERROR: System Errors]
    C --> G[DEBUG: Development Info]
    
    D --> H[Log Storage]
    E --> H
    F --> H
    G --> H
    
    H --> I[Database Logs]
    H --> J[File Logs]
    H --> K[External Monitoring]
    
    I --> L[Audit Trail]
    J --> M[System Monitoring]
    K --> N[Performance Metrics]
    
    L --> O[Admin Dashboard]
    M --> O
    N --> O
```

---

## üéØ KEY INTEGRATION POINTS

### 1. **Face Recognition Integration**
- Camera input ‚Üí Image processing ‚Üí Face encoding ‚Üí Database comparison ‚Üí Attendance recording

### 2. **Role-Based Access Control**
- JWT token ‚Üí Role validation ‚Üí Permission check ‚Üí API access

### 3. **Real-time Notifications**
- System events ‚Üí Notification service ‚Üí WebSocket ‚Üí Frontend updates

### 4. **File Upload/Export**
- File selection ‚Üí Upload to storage ‚Üí Database reference ‚Üí Download/Export

### 5. **Audit Trail**
- User actions ‚Üí Log service ‚Üí Database storage ‚Üí Admin monitoring

---

## üìã BACKEND IMPLEMENTATION PRIORITIES

### Phase 1 (Core Features):
1. **Authentication & Authorization**
2. **Employee CRUD Operations**
3. **Basic Attendance Management**
4. **Database Setup & Models**

### Phase 2 (Advanced Features):
1. **Face Recognition Integration**
2. **Payroll Calculation**
3. **Leave Management**
4. **Audit Logging**

### Phase 3 (Enhancement):
1. **Real-time Notifications**
2. **Advanced Reports**
3. **File Management**
4. **Performance Optimization**

---

## üîó API ENDPOINT SUMMARY

| Module | Endpoint | Method | Description |
|--------|----------|--------|-------------|
| Auth | `/api/auth/login` | POST | User authentication |
| Auth | `/api/auth/logout` | POST | User logout |
| Employees | `/api/employees` | GET | List employees |
| Employees | `/api/employees` | POST | Create employee |
| Employees | `/api/employees/:id` | PUT | Update employee |
| Employees | `/api/employees/:id` | DELETE | Delete employee |
| Attendance | `/api/attendance` | GET | Get attendance records |
| Attendance | `/api/attendance/face-recognition` | POST | Face recognition check-in |
| Payroll | `/api/payroll` | GET | Get payroll records |
| Payroll | `/api/payroll/calculate` | POST | Calculate payroll |
| Leaves | `/api/leaves` | GET | Get leave requests |
| Leaves | `/api/leaves` | POST | Create leave request |
| Dashboard | `/api/dashboard/stats` | GET | Get dashboard statistics |
| Logs | `/api/logs` | GET | Get audit logs |

---

**Backend team c√≥ th·ªÉ s·ª≠ d·ª•ng flow diagram n√†y ƒë·ªÉ hi·ªÉu r√µ c√°ch h·ªá th·ªëng ho·∫°t ƒë·ªông v√† implement API theo ƒë√∫ng logic!** üöÄ
H·ªá th·ªëng g·ªìm 3 ph·∫ßn ch√≠nh:

Th√†nh ph·∫ßn	C√¥ng ngh·ªá	Vai tr√≤
Frontend	React (Port 5173)	Giao di·ªán ng∆∞·ªùi d√πng (nh√¢n vi√™n, qu·∫£n l√Ω, admin)
Backend API	Flask (Port 5000)	X·ª≠ l√Ω logic nghi·ªáp v·ª•, x√°c th·ª±c, t√≠nh to√°n, l∆∞u tr·ªØ d·ªØ li·ªáu
Database	SQLite (hr_system.db)	L∆∞u d·ªØ li·ªáu nh√¢n s·ª±, ch·∫•m c√¥ng, l∆∞∆°ng, ƒë∆°n ngh·ªâ, nh·∫≠t k√Ω h·ªá th·ªëng

Ngo√†i ra c√≤n c√≥ c√°c th√†nh ph·∫ßn ph·ª•:

Face Recognition (OpenCV) ‚Üí d√πng camera nh·∫≠n di·ªán khu√¥n m·∫∑t khi ch·∫•m c√¥ng.

File Storage ‚Üí l∆∞u ·∫£nh, t√†i li·ªáu nh√¢n vi√™n.

Audit Logs ‚Üí ghi l·∫°i h√†nh ƒë·ªông ng∆∞·ªùi d√πng (ai t·∫°o, s·ª≠a, x√≥a d·ªØ li·ªáu).

üîê 2Ô∏è‚É£ Quy tr√¨nh x√°c th·ª±c ƒëƒÉng nh·∫≠p (Authentication Flow)

Ng∆∞·ªùi d√πng nh·∫≠p email v√† m·∫≠t kh·∫©u tr√™n giao di·ªán (Frontend).

G·ª≠i y√™u c·∫ßu POST /api/auth/login ƒë·∫øn Backend.

Backend ki·ªÉm tra t√†i kho·∫£n trong Database.

N·∫øu h·ª£p l·ªá ‚Üí Backend t·∫°o JWT token v√† g·ª≠i l·∫°i cho Frontend.

Frontend l∆∞u token v√†o localStorage v√† ƒëi·ªÅu h∆∞·ªõng theo vai tr√≤:

Admin / Manager ‚Üí /dashboard

Employee ‚Üí /employee

Token n√†y s·∫Ω ƒë∆∞·ª£c d√πng cho m·ªçi API kh√°c ƒë·ªÉ x√°c ƒë·ªãnh quy·ªÅn truy c·∫≠p.

üë• 3Ô∏è‚É£ Quy tr√¨nh qu·∫£n l√Ω nh√¢n vi√™n (Employee Management Flow)

Qu·∫£n l√Ω ho·∫∑c admin ƒëƒÉng nh·∫≠p ‚Üí v√†o trang danh s√°ch nh√¢n vi√™n.

C√≥ th·ªÉ:

Xem chi ti·∫øt nh√¢n vi√™n.

Th√™m m·ªõi nh√¢n vi√™n ‚Üí g·ª≠i POST /api/employees.

Ch·ªânh s·ª≠a ‚Üí c·∫≠p nh·∫≠t th√¥ng tin.

X√≥a (Soft Delete) ‚Üí ƒë·ªïi tr·∫°ng th√°i ‚Äúƒë√£ ngh·ªâ‚Äù.

Xu·∫•t d·ªØ li·ªáu ‚Üí PDF / Excel qua /api/employees/export.

M·ªçi thao t√°c ƒë·ªÅu ƒë∆∞·ª£c l∆∞u v√†o CSDL v√† c·∫≠p nh·∫≠t l·∫°i UI.

‚è∞ 4Ô∏è‚É£ Quy tr√¨nh ch·∫•m c√¥ng b·∫±ng khu√¥n m·∫∑t (Attendance Management Flow)

Nh√¢n vi√™n m·ªü c·ªïng nh√¢n vi√™n ‚Üí b·∫≠t camera.

H·ªá th·ªëng ch·ª•p ·∫£nh, g·ª≠i ƒë·∫øn /api/attendance/face-recognition.

AI x·ª≠ l√Ω ·∫£nh ‚Üí tr√≠ch xu·∫•t m√£ nh·∫≠n d·∫°ng khu√¥n m·∫∑t (face encoding).

So s√°nh v·ªõi d·ªØ li·ªáu trong DB:

N·∫øu kh√¥ng kh·ªõp ‚Üí b√°o ‚ÄúKh√¥ng nh·∫≠n di·ªán ƒë∆∞·ª£c‚Äù.

N·∫øu kh·ªõp v√† ƒë·ªô ch√≠nh x√°c > 80% ‚Üí ghi c√¥ng v√†o DB.

H·ªá th·ªëng x√°c ƒë·ªãnh l√† check-in hay check-out t√πy th·ªùi ƒëi·ªÉm.

Tr·∫£ v·ªÅ k·∫øt qu·∫£ v√† hi·ªÉn th·ªã th√¥ng b√°o cho ng∆∞·ªùi d√πng.

üí∞ 5Ô∏è‚É£ Quy tr√¨nh t√≠nh l∆∞∆°ng (Payroll Flow)

Qu·∫£n l√Ω ch·ªçn th√°ng v√† nh√¢n vi√™n c·∫ßn t√≠nh l∆∞∆°ng.

G·ª≠i y√™u c·∫ßu POST /api/payroll/calculate.

Backend:

L·∫•y d·ªØ li·ªáu ch·∫•m c√¥ng ‚Üí t√≠nh l∆∞∆°ng c∆° b·∫£n, l√†m th√™m, th∆∞·ªüng, kh·∫•u tr·ª´.

√Åp d·ª•ng quy t·∫Øc thu·∫ø TNCN ‚Üí t√≠nh l∆∞∆°ng th·ª±c nh·∫≠n.

L∆∞u k·∫øt qu·∫£ v√†o b·∫£ng PAYROLL.

C√≥ th·ªÉ xu·∫•t PDF / Excel ho·∫∑c g·ª≠i phi·∫øu l∆∞∆°ng qua email.

üìÖ 6Ô∏è‚É£ Quy tr√¨nh xin ngh·ªâ ph√©p (Leave Request Flow)

Nh√¢n vi√™n g·ª≠i ƒë∆°n ngh·ªâ qua /api/leaves.

Backend l∆∞u ƒë∆°n v√† g·ª≠i th√¥ng b√°o cho Manager.

Manager xem danh s√°ch ƒë∆°n ‚Äúpending‚Äù ‚Üí c√≥ th·ªÉ duy·ªát ho·∫∑c t·ª´ ch·ªëi.

Backend c·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n v√† th√¥ng b√°o l·∫°i cho nh√¢n vi√™n.

üîç 7Ô∏è‚É£ Ghi nh·∫≠t k√Ω h·ªá th·ªëng (Audit Log Flow)

M·ªçi h√†nh ƒë·ªông (t·∫°o, s·ª≠a, x√≥a, ƒëƒÉng nh·∫≠p, v.v.) s·∫Ω:

G·ª≠i qua Audit Log Service.

Ghi l·∫°i v√†o b·∫£ng AUDIT_LOGS v·ªõi c√°c th√¥ng tin:

timestamp ‚Äì th·ªùi gian

user ‚Äì ng∆∞·ªùi th·ª±c hi·ªán

action ‚Äì h√†nh ƒë·ªông

resource ‚Äì lo·∫°i t√†i nguy√™n (nh√¢n vi√™n, ch·∫•m c√¥ng, l∆∞∆°ng, ‚Ä¶)

details ‚Äì m√¥ t·∫£ chi ti·∫øt

ipAddress ‚Äì ƒë·ªãa ch·ªâ IP

Admin c√≥ th·ªÉ xem l·∫°i qua /api/logs.

üìä 8Ô∏è‚É£ Dashboard (Trang t·ªïng quan)

Khi ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p, h·ªá th·ªëng ki·ªÉm tra role:

Admin/Manager ‚Üí hi·ªÉn th·ªã s·ªë li·ªáu t·ªïng h·ª£p (nh√¢n vi√™n, l∆∞∆°ng, ngh·ªâ ph√©p).

Employee ‚Üí hi·ªÉn th·ªã d·ªØ li·ªáu c√° nh√¢n (ch·∫•m c√¥ng, l∆∞∆°ng, h·ªì s∆°).

API /api/dashboard/stats t·ªïng h·ª£p nhi·ªÅu b·∫£ng ƒë·ªÉ tr·∫£ d·ªØ li·ªáu th·ªëng k√™.

üß† 9Ô∏è‚É£ Nh·∫≠n di·ªán khu√¥n m·∫∑t theo th·ªùi gian th·ª±c (Real-time Recognition)

Camera g·ª≠i lu·ªìng video / ·∫£nh base64 ƒë·∫øn Backend.

AI x·ª≠ l√Ω: ph√°t hi·ªán khu√¥n m·∫∑t ‚Üí m√£ h√≥a ‚Üí so s√°nh ‚Üí tr·∫£ v·ªÅ ƒë·ªô ch√≠nh x√°c.

N·∫øu v∆∞·ª£t ng∆∞·ª°ng (80%) ‚Üí t·ª± ƒë·ªông ghi c√¥ng v√†o b·∫£ng ATTENDANCE.

üóÑÔ∏è üî¢ 10Ô∏è‚É£ C·∫•u tr√∫c c∆° s·ªü d·ªØ li·ªáu

Bao g·ªìm c√°c b·∫£ng:

USERS ‚Äì ng∆∞·ªùi d√πng (ƒëƒÉng nh·∫≠p)

EMPLOYEES ‚Äì th√¥ng tin nh√¢n vi√™n

ATTENDANCE ‚Äì d·ªØ li·ªáu ch·∫•m c√¥ng

PAYROLL ‚Äì l∆∞∆°ng

LEAVES ‚Äì ƒë∆°n ngh·ªâ ph√©p

FACE_ENCODINGS ‚Äì d·ªØ li·ªáu khu√¥n m·∫∑t

AUDIT_LOGS ‚Äì nh·∫≠t k√Ω h·ªá th·ªëng

‚Üí C√°c b·∫£ng ƒë∆∞·ª£c li√™n k·∫øt theo employee_id, user_id (quan h·ªá 1-nhi·ªÅu).

üöÄ 11Ô∏è‚É£ Quy tr√¨nh tri·ªÉn khai (Deployment Flow)

Code ƒë∆∞·ª£c ph√°t tri·ªÉn ‚Üí review ‚Üí test ‚Üí build.

Frontend build React ‚Üí Docker container (port 5173).

Backend build Flask ‚Üí Docker container (port 5000).

Database (Postgres ho·∫∑c SQLite) container (port 5432).

Tri·ªÉn khai l√™n m√¥i tr∆∞·ªùng Production qua Load Balancer.

üë£ 12Ô∏è‚É£ H√†nh tr√¨nh ng∆∞·ªùi d√πng (User Journey)
Vai tr√≤	Quy tr√¨nh ch√≠nh
Admin	ƒêƒÉng nh·∫≠p ‚Üí Qu·∫£n l√Ω nh√¢n vi√™n ‚Üí ƒêƒÉng k√Ω khu√¥n m·∫∑t ‚Üí Theo d√µi ch·∫•m c√¥ng ‚Üí T·∫°o l∆∞∆°ng ‚Üí B√°o c√°o
Manager	ƒêƒÉng nh·∫≠p ‚Üí Duy·ªát ngh·ªâ ph√©p ‚Üí Theo d√µi nh√¢n vi√™n ‚Üí Xem l∆∞∆°ng ph√≤ng ban
Employee	ƒêƒÉng nh·∫≠p ‚Üí Ch·∫•m c√¥ng b·∫±ng khu√¥n m·∫∑t ‚Üí Xem c√¥ng ‚Üí G·ª≠i ƒë∆°n ngh·ªâ ‚Üí Xem l∆∞∆°ng c√° nh√¢n
‚öôÔ∏è 13Ô∏è‚É£ X·ª≠ l√Ω l·ªói (Error Handling Flow)

400 ‚Üí D·ªØ li·ªáu sai (Validation Error)

401 ‚Üí Ch∆∞a ƒëƒÉng nh·∫≠p

403 ‚Üí Kh√¥ng c√≥ quy·ªÅn

404 ‚Üí Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu

500 ‚Üí L·ªói h·ªá th·ªëng

Frontend s·∫Ω hi·ªÉn th·ªã th√¥ng b√°o th√¢n thi·ªán v√† Backend l∆∞u log chi ti·∫øt ƒë·ªÉ debug.

üìä 14Ô∏è‚É£ Gi√°m s√°t & Logging (Monitoring)

H·ªá th·ªëng chia log theo c·∫•p ƒë·ªô:

INFO: ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng

WARN: c·∫£nh b√°o

ERROR: l·ªói h·ªá th·ªëng

DEBUG: th√¥ng tin ph·ª•c v·ª• ph√°t tri·ªÉn

C√°c log ƒë∆∞·ª£c l∆∞u v√†o:

Database (AUDIT_LOGS)

File logs (log.txt)

Ho·∫∑c c√¥ng c·ª• gi√°m s√°t b√™n ngo√†i (Prometheus, Grafana).

üéØ 15Ô∏è‚É£ C√°c ƒëi·ªÉm t√≠ch h·ª£p ch√≠nh (Integration Points)

Face Recognition ‚Äì K·∫øt n·ªëi AI & camera ƒë·ªÉ x√°c ƒë·ªãnh danh t√≠nh.

RBAC ‚Äì X√°c th·ª±c b·∫±ng JWT v√† ki·ªÉm tra quy·ªÅn truy c·∫≠p.

Real-time Notifications ‚Äì D√πng WebSocket ƒë·ªÉ c·∫≠p nh·∫≠t tr·∫°ng th√°i ngay l·∫≠p t·ª©c.

File Management ‚Äì Upload v√† xu·∫•t file t√†i li·ªáu, b√°o c√°o.

Audit Logging ‚Äì Theo d√µi m·ªçi h√†nh ƒë·ªông c·ªßa ng∆∞·ªùi d√πng.

üß© 16Ô∏è‚É£ ∆Øu ti√™n tri·ªÉn khai Backend (Backend Implementation)
Giai ƒëo·∫°n	T√≠nh nƒÉng ch√≠nh
Phase 1	ƒêƒÉng nh·∫≠p, qu·∫£n l√Ω nh√¢n vi√™n, ch·∫•m c√¥ng c∆° b·∫£n, c·∫•u tr√∫c DB
Phase 2	T√≠ch h·ª£p nh·∫≠n di·ªán khu√¥n m·∫∑t, t√≠nh l∆∞∆°ng, ngh·ªâ ph√©p, audit log
Phase 3	Th√¥ng b√°o real-time, b√°o c√°o n√¢ng cao, qu·∫£n l√Ω file, t·ªëi ∆∞u hi·ªáu nƒÉngimage.png